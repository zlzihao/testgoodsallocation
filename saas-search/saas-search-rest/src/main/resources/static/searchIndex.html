<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>搜索演示</title>
    <script typet="text/javascript" src="http://libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>
</head>
<body>
<div style="border-color: cadetblue;text-align: center">
    <input style="height: 21px;width: 400px;" id="keyword" type="text" name="输入关键字">
    <span style="height: 28px;font-size: 16px;border: solid;border-color: #a5aece;background-color: #587bff;color: #f0f1f5"
          id="doSearch">&nbsp;&nbsp;搜索一下&nbsp;&nbsp;</span>
</div>
<div style="margin: 10px 40px;">
    共找到<span id="totalCount" style="color: red;">0</span>条结果，
    共<span id="totalPage" style="color: red;">0</span>页，
    每页
    <span>
            <select id="pageSizeOpt">
                <option value="1">1</option>
                <option value="5">5</option>
                <option value="10" selected>10</option>
                <option value="50">50</option>
                <option value="100">100</option>
                <option value="500">more</option>
            </select>
    </span>
    条
</div>
<div style="margin:10px 40px;border: dashed;border-width:1px;border-radius:8px;">
    <div id="content" style="margin:10px;text-align: left">
        搜索结果...
    </div>
</div>
</body>
<script>
    $(function () {

        $('#keyword').bind('keyup', function (event) {
            if (event.keyCode == "13") {
                //回车执行查询
                $('#doSearch').click();
            }
        });

        $('#pageSizeOpt').change(function (event) {
            //回车执行查询
            $('#doSearch').click();
        });

        $("#doSearch").click(function () {
            //alert(55);
            var keyword = $("#keyword").val();
            var pageSizeVal = $("#pageSizeOpt").val();
            console.info("keyword:" + keyword+",pageSizeVal:"+pageSizeVal);
            var key = {
                "keyword": keyword,
                "pageModel": {"curPage": 1, "pageSize": pageSizeVal},
                "sortModels": [{"dire": "string", "fieldName": "string"}]
            }
            $.ajax({
                type: "POST",
//                url: "http://localhost:8330/public/search/matchProduct",
                url: "http://10.200.103.18:8330/public/search/matchProduct",
//                url: "http://134.175.222.68:8330/public/search/matchProduct",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify(key),
                dataType: "json",
                success: function (message) {
                    console.info("code:" + message.code);
                    console.info("msg:" + message.msg);

                    var code = message.code;
                    var msg = message.msg;
                    var data = message.data;
                    console.info("data:" + data);
                    if (code != "SUCCESS" || data == null) {
                        alert("异常码[" + code + "]，信息[" + msg + "]");
                        return;
                    }
                    var productList = data.productVos;
                    var pageVo = data.pageVo;
                    var totalCount = 0;
                    var totalPage = 0;
                    if (pageVo != null) {
                        console.info("[pageVo]" + JSON.stringify(pageVo))
                        totalCount = pageVo.totalCount;
                        totalPage = pageVo.totalPage;
                    }
                    var content = "";
                    if (productList != null && productList.length > 0) {
                        var item = null;
                        content = "<table border='0' cellpadding='5' cellspacing='10'><tr><td>序号</td><td>ID</td><td>商品名</td><td>库存</td><td>价格</td><td>图片</td></tr>"
                        for (var n = 1; n <= productList.length; n++) {

//                            console.info( "[" + (n) + "]" + JSON.stringify(productList[n-1]))
                            item = productList[n - 1];
//                            content += "[" + (n) + "]&nbsp;&nbsp;" + item.id + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
//                                + item.name + "("+item.spuStockCount+")&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
//                                + item.minPrice + "~" + item.maxPrice + "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"
//                                + item.img + "<br/>";

                            content += "<tr>";
                            content += "<td>"+n+"</td>";
                            content += "<td>"+item.id+"</td>";
                            content += "<td>"+item.name+"</td>";
                            content += "<td>"+item.spuStockCount+"</td>";
                            content += "<td>"+item.minPrice+"~"+item.maxPrice+"</td>";
                            content += "<td><a href='"+item.img+"' target='_blank'>"+item.img+"</a></td>";
                            content += "</tr>";
                        }
                        content += "</table>";
                    } else {
                        content = "搜不到你";
                    }
                    $("#content").html(content);
                    $("#totalCount").html(totalCount);
                    $("#totalPage").html(totalPage);
                    //alert("提交成功"+JSON.stringify(message));
                },
                error: function (message) {
                    alert("提交失败:" + JSON.stringify(message));
                }
            });
        });
    });
</script>
</html>