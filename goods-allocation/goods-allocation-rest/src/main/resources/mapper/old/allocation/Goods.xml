<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.nome.saas.allocation.repository.old.allocation.dao.GoodsDOMapper2" >
    <select id="getGoodsAreaLevelList" resultType="cn.nome.saas.allocation.model.old.allocation.GoodsAreaLevel">
		select matcode as matCode,level as levels,categoryName as categoryName from goods_info
    </select>
	<insert id="addGoodsAreaLevel" parameterType="java.util.List">
		insert into goods_area_level(matCode,area,level,categoryName) values
		<foreach collection="list" item="item" index="index"
			separator=","> 
			(#{item.matCode},#{item.area},#{item.level},#{item.categoryName})
		</foreach>
	</insert>
	<insert id="addGoodsAreaLevelDetail">
			insert into goods_area_level_detail(MatCode,ShopID)
			select goods_area_level.MatCode,shop_info.ShopID
			from shop_info INNER JOIN goods_area_level 
			on goods_area_level.area=goodsarea and case when CategoryName='男装' then MenLevel when CategoryName='女装' then WomenLevel else CommodityLevel end >=goods_area_level.`level`
	</insert>
	<delete id="deleteGoodsAreaLevel">
        delete from goods_area_level
    </delete>
	<delete id="deleteGoodsAreaLevelDetail">
        delete from goods_area_level_detail
    </delete>
    <select id="getAllocationProhibitedGoods" resultType="java.lang.String">
		select matcode from goods_info where IsAllocationProhibited=1
    </select>
</mapper>