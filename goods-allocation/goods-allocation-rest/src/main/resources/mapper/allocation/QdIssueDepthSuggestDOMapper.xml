<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.nome.saas.allocation.repository.dao.allocation.QdIssueDepthSuggestDOMapper" >

    <resultMap id="BaseResultMap" type="cn.nome.saas.allocation.repository.entity.allocation.QdIssueDepthSuggestDO" >
        <result column="id" property="id" />
        <result column="match_type" property="matchType" />
        <result column="level" property="level" />
        <result column="depth" property="depth" />
        <result column="avg_depth" property="avgDepth" />
        <result column="is_deal" property="isDeal" />
        <result column="remark" property="remark" />
        <result column="type_name" property="typeName" />
    </resultMap>

    <select id = "queryAll" resultMap="BaseResultMap">
        select id,match_type,level,depth,type_name from qd_issue_depth_suggest
    </select>

    <select id="countForDealStatus" resultType="java.lang.Integer">
        select count(*) from qd_issue_depth_suggest where is_deal = #{isDeal}
    </select>

    <update id="batchUpdateInfo">
        <foreach collection="list" item="item" index="index" open="" close="" separator=";">
            UPDATE qd_issue_depth_suggest
            <set>
                <if test="item.isDeal != null">
                    is_deal = #{item.isDeal},
                </if>
                <if test="item.remark != null">
                    remark = #{item.remark},
                </if>
                <if test="item.avgDepth != null">
                    avg_depth = #{item.avgDepth},
                </if>
            </set>
            <where>
                id = #{item.id}
            </where>
        </foreach>
    </update>
    <select id="queryAvgDepth" resultMap="BaseResultMap">
        select distinct match_type,avg_depth from qd_issue_depth_suggest
    </select>
</mapper>